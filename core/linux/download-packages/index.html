<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>My Hugo</title>
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/site.css">
    <script src="/js/nav.js"></script>

    

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



  </head>

<head>
  <meta charset="utf-8">
    <title>My Hugo</title>
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/site.css">
    <script src="/js/nav.js"></script>

  

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



</head>

<body>
    
 <div id="menu-container"></div>

 


    
  
<div class="van-content-container">
  <div id="index-container" class="van-content-index"></div>
  <div class="van-content">
    <h1>Download Packages Without Installing them</h1>
    <p>Package managers (e.g. apt, yum) search the package repositories, download packages (and their dependencies) and install them.
What if we want to just download them without installation? These are scenarios:</p>
<ul>
<li>we want to install those packages on many systems or hosts</li>
<li>we want to repeat to install them for debugging purpose or different version, such as docker images</li>
</ul>
<h2 id="rpm-for-redhat-centos-and-so-on">rpm for redhat, centos and so on</h2>
<h3 id="yum-utils">yum-utils</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@0268aef3d0ef x<span class="o">]</span><span class="c1"># yum -y install yum-utils</span>
</span></span><span class="line"><span class="cl">Loaded plugins: fastestmirror
</span></span><span class="line"><span class="cl">Loading mirror speeds from cached hostfile
</span></span><span class="line"><span class="cl">Setting up Install Process
</span></span><span class="line"><span class="cl">Resolving Dependencies
</span></span><span class="line"><span class="cl">--&gt; Running transaction check
</span></span><span class="line"><span class="cl">---&gt; Package yum-utils.noarch 0:1.1.16-21.el5.centos <span class="nb">set</span> to be updated
</span></span><span class="line"><span class="cl">--&gt; Finished Dependency Resolution
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Dependencies <span class="nv">Resolved</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">========================================================================================================================</span>
</span></span><span class="line"><span class="cl"> Package                    Arch                    Version                                 Repository             <span class="nv">Size</span>
</span></span><span class="line"><span class="cl"><span class="o">========================================================================================================================</span>
</span></span><span class="line"><span class="cl">Installing:
</span></span><span class="line"><span class="cl"> yum-utils                  noarch                  1.1.16-21.el5.centos                    base                   <span class="m">74</span> k
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Transaction <span class="nv">Summary</span>
</span></span><span class="line"><span class="cl"><span class="o">========================================================================================================================</span>
</span></span><span class="line"><span class="cl">Install       <span class="m">1</span> Package<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl">Upgrade       <span class="m">0</span> Package<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Total download size: <span class="m">74</span> k
</span></span><span class="line"><span class="cl">Is this ok <span class="o">[</span>y/N<span class="o">]</span>: y
</span></span><span class="line"><span class="cl">Downloading Packages:
</span></span><span class="line"><span class="cl">yum-utils-1.1.16-21.el5.centos.noarch.rpm                                                        <span class="p">|</span>  <span class="m">74</span> kB     00:00
</span></span><span class="line"><span class="cl">Running rpm_check_debug
</span></span><span class="line"><span class="cl">Running Transaction Test
</span></span><span class="line"><span class="cl">Finished Transaction Test
</span></span><span class="line"><span class="cl">Transaction Test Succeeded
</span></span><span class="line"><span class="cl">Running Transaction
</span></span><span class="line"><span class="cl">  Installing     : yum-utils                                                                                        1/1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Installed:
</span></span><span class="line"><span class="cl">  yum-utils.noarch 0:1.1.16-21.el5.centos
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Complete!
</span></span></code></pre></div><p>Now try to download gcc44 (itself)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@0268aef3d0ef x<span class="o">]</span><span class="c1"># yumdownloader gcc44</span>
</span></span><span class="line"><span class="cl">Loaded plugins: fastestmirror
</span></span><span class="line"><span class="cl">Loading mirror speeds from cached hostfile
</span></span><span class="line"><span class="cl">gcc44-4.4.7-1.el5.x86_64.rpm                                                                     <span class="p">|</span>  <span class="m">12</span> MB     00:08
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@0268aef3d0ef x<span class="o">]</span><span class="c1"># ls</span>
</span></span><span class="line"><span class="cl">Dockerfile  gcc44-4.4.7-1.el5.x86_64.rpm
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@0268aef3d0ef x<span class="o">]</span><span class="c1"># ls -al</span>
</span></span><span class="line"><span class="cl">total <span class="m">12452</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">2</span> <span class="m">1094144924</span> <span class="m">1093140993</span>     <span class="m">4096</span> Mar  <span class="m">9</span> 22:22 .
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">1</span> root       root           <span class="m">4096</span> Mar  <span class="m">9</span> 22:20 ..
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> root       root       <span class="m">12735725</span> Jan <span class="m">10</span>  <span class="m">2013</span> gcc44-4.4.7-1.el5.x86_64.rpm
</span></span></code></pre></div><p>If we want to download a package with all its dependents:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@0268aef3d0ef x<span class="o">]</span><span class="c1"># yumdownloader --resolve gcc44</span>
</span></span><span class="line"><span class="cl">Loaded plugins: fastestmirror
</span></span><span class="line"><span class="cl">Loading mirror speeds from cached hostfile
</span></span><span class="line"><span class="cl">--&gt; Running transaction check
</span></span><span class="line"><span class="cl">---&gt; Package gcc44.x86_64 0:4.4.7-1.el5 <span class="nb">set</span> to be updated
</span></span><span class="line"><span class="cl">--&gt; Processing Dependency: <span class="nv">libgomp</span> <span class="o">=</span> 4.4.7-1.el5 <span class="k">for</span> package: gcc44
</span></span><span class="line"><span class="cl">--&gt; Processing Dependency: glibc-devel &gt;<span class="o">=</span> 2.2.90-12 <span class="k">for</span> package: gcc44
</span></span><span class="line"><span class="cl">--&gt; Processing Dependency: binutils220 <span class="k">for</span> package: gcc44
</span></span><span class="line"><span class="cl">--&gt; Processing Dependency: libgmpxx.so.3<span class="o">()(</span>64bit<span class="o">)</span> <span class="k">for</span> package: gcc44
</span></span><span class="line"><span class="cl">--&gt; Processing Dependency: libgmp.so.3<span class="o">()(</span>64bit<span class="o">)</span> <span class="k">for</span> package: gcc44
</span></span><span class="line"><span class="cl">--&gt; Processing Dependency: libgomp.so.1<span class="o">()(</span>64bit<span class="o">)</span> <span class="k">for</span> package: gcc44
</span></span><span class="line"><span class="cl">--&gt; Running transaction check
</span></span><span class="line"><span class="cl">---&gt; Package binutils220.x86_64 0:2.20.51.0.2-5.29.el5 <span class="nb">set</span> to be updated
</span></span><span class="line"><span class="cl">---&gt; Package glibc-devel.x86_64 0:2.5-123.el5_11.3 <span class="nb">set</span> to be updated
</span></span><span class="line"><span class="cl">--&gt; Processing Dependency: glibc-headers <span class="o">=</span> 2.5-123.el5_11.3 <span class="k">for</span> package: glibc-devel
</span></span><span class="line"><span class="cl">--&gt; Processing Dependency: glibc-headers <span class="k">for</span> package: glibc-devel
</span></span><span class="line"><span class="cl">---&gt; Package gmp.x86_64 0:4.1.4-10.el5 <span class="nb">set</span> to be updated
</span></span><span class="line"><span class="cl">---&gt; Package libgomp.x86_64 0:4.4.7-1.el5 <span class="nb">set</span> to be updated
</span></span><span class="line"><span class="cl">--&gt; Running transaction check
</span></span><span class="line"><span class="cl">---&gt; Package glibc-headers.x86_64 0:2.5-123.el5_11.3 <span class="nb">set</span> to be updated
</span></span><span class="line"><span class="cl">--&gt; Processing Dependency: kernel-headers &gt;<span class="o">=</span> 2.2.1 <span class="k">for</span> package: glibc-headers
</span></span><span class="line"><span class="cl">--&gt; Processing Dependency: kernel-headers <span class="k">for</span> package: glibc-headers
</span></span><span class="line"><span class="cl">--&gt; Running transaction check
</span></span><span class="line"><span class="cl">---&gt; Package kernel-headers.x86_64 0:2.6.18-419.el5 <span class="nb">set</span> to be updated
</span></span><span class="line"><span class="cl">--&gt; Finished Dependency Resolution
</span></span><span class="line"><span class="cl">./gcc44-4.4.7-1.el5.x86_64.rpm already exists and appears to be <span class="nb">complete</span>
</span></span><span class="line"><span class="cl">gmp-4.1.4-10.el5.x86_64.rpm                                                                      <span class="p">|</span> <span class="m">201</span> kB     00:00
</span></span><span class="line"><span class="cl">glibc-devel-2.5-123.el5_11.3.x86_64.rpm                                                          <span class="p">|</span> 2.4 MB     00:01
</span></span><span class="line"><span class="cl">libgomp-4.4.7-1.el5.x86_64.rpm                                                                   <span class="p">|</span>  <span class="m">71</span> kB     00:00
</span></span><span class="line"><span class="cl">glibc-headers-2.5-123.el5_11.3.x86_64.rpm                                                        <span class="p">|</span> <span class="m">602</span> kB     00:00
</span></span><span class="line"><span class="cl">kernel-headers-2.6.18-419.el5.x86_64.rpm                                                         <span class="p">|</span> 1.5 MB     00:01
</span></span><span class="line"><span class="cl">binutils220-2.20.51.0.2-5.29.el5.x86_64.rpm                                                      <span class="p">|</span> <span class="m">986</span> kB     00:00
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@0268aef3d0ef x<span class="o">]</span><span class="c1"># ls -al</span>
</span></span><span class="line"><span class="cl">total <span class="m">18356</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">2</span> <span class="m">1094144924</span> <span class="m">1093140993</span>     <span class="m">4096</span> Mar  <span class="m">9</span> 22:25 .
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">1</span> root       root           <span class="m">4096</span> Mar  <span class="m">9</span> 22:20 ..
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> root       root        <span class="m">1009201</span> Feb <span class="m">22</span>  <span class="m">2012</span> binutils220-2.20.51.0.2-5.29.el5.x86_64.rpm
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> <span class="m">1094144924</span> root       <span class="m">12735725</span> Jan <span class="m">10</span>  <span class="m">2013</span> gcc44-4.4.7-1.el5.x86_64.rpm
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> root       root        <span class="m">2547087</span> Aug <span class="m">17</span>  <span class="m">2015</span> glibc-devel-2.5-123.el5_11.3.x86_64.rpm
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> root       root         <span class="m">616924</span> Aug <span class="m">17</span>  <span class="m">2015</span> glibc-headers-2.5-123.el5_11.3.x86_64.rpm
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> root       root         <span class="m">205765</span> Nov <span class="m">19</span>  <span class="m">2007</span> gmp-4.1.4-10.el5.x86_64.rpm
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> root       root        <span class="m">1583685</span> Feb <span class="m">25</span>  <span class="m">2017</span> kernel-headers-2.6.18-419.el5.x86_64.rpm
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> root       root          <span class="m">72734</span> Jan <span class="m">10</span>  <span class="m">2013</span> libgomp-4.4.7-1.el5.x86_64.rpm
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@0268aef3d0ef x<span class="o">]</span><span class="c1">#</span>
</span></span></code></pre></div><h3 id="yum-plugin-downloadonly">yum-plugin-downloadonly</h3>
<ul>
<li>Note: this plug-in is not supported in centos5</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># yum install yum-plugin-downloadonly</span>
</span></span><span class="line"><span class="cl"><span class="c1"># yum install --downloadonly &lt;package-name&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># yum install --downloadonly --downloaddir=&lt;directory&gt; &lt;package-name&gt;</span>
</span></span></code></pre></div><ul>
<li>without <code>--downloaddir</code>, by default the packages are saved in <code>/var/cache/yum/</code></li>
</ul>
<h2 id="apt-for-ubuntu-debian-and-so-on">apt for ubuntu, debian and so on</h2>
<ul>
<li>use <code>--download-only</code> or <code>-d</code> option of <code>apt-get</code>
<pre tabindex="0"><code>-d, --download-only
   Download only; package files are only retrieved, not unpacked or installed.
   Configuration Item: APT::Get::Download-Only.
</code></pre><ul>
<li><code>apt-get -d</code> doesn&rsquo;t download things if they have installed already. Use <code>apt download &lt;package_name&gt;</code> instead.</li>
</ul>
</li>
<li>Don&rsquo;t forget the option <code>-o</code>, which lets you download anywhere you want,
although you have to create <code>archives</code>, <code>lock</code> and <code>partial</code> first (the command prints what&rsquo;s needed).
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt-get install -d -o<span class="o">=</span>dir::cache<span class="o">=</span>/tmp whateveryouwant
</span></span></code></pre></div></li>
</ul>

  </div>
</div>



    
    
    

    
    <script src="/js/menu-module.js"></script>
    <script src="/js/index-module.js"></script>
</body>
</html>
