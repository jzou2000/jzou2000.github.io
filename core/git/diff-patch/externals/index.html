<!DOCTYPE html>
<html lang="en">




  <head>
    <meta charset="utf-8">
<title>My Hugo</title>
<link rel="stylesheet" type="text/css" href="/css/syntax.css">
<link rel="stylesheet" type="text/css" href="/css/site.css">
<script src="/js/nav.js"></script>

    

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



  </head>

  <body>
    
 <div id="menu-container"></div>

 


    
  
<div class="van-content-container">
  <div id="index-container" class="van-content-index"></div>
  <div class="van-content">
    <h1>External Tree</h1>
    <p>Sometimes we want to diff and patch an external tree, i.e. not in git, for example,
we have folked a repo, but we want to keep updated with the original repo.</p>
<ul>
<li>this is different from branch, which is in the same git repo.</li>
</ul>
<p>We can use posix utility <code>diff</code> and <code>patch</code> to achieve the purpose.</p>
<ol>
<li>Compare two trees (folders recursively) and generate patch file.
The patch file is the command (explained by <code>patch</code>) that convert <code>.</code> to <code>$other_tree</code>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">diff -x <span class="s1">&#39;.git&#39;</span> --new-file -aur . <span class="nv">$other_tree</span> &gt; ../to-be-other_tree.patch
</span></span></code></pre></div>Options explain
<ul>
<li><code>-r</code> recursively</li>
<li><code>-a</code> treat all files as text</li>
<li><code>-u</code> unified context, used by <code>patch</code></li>
<li><code>-x</code> pattern to be ignored. We don&rsquo;t want to access <code>.git</code> bobs in two folders</li>
<li><code>--new-file</code> treat missing file as empty, this will create files that exist only in <code>$other_tree</code>
and remove files that exist only in <code>.</code></li>
</ul>
</li>
<li>Apply the patch file to the current folder
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">patch -p0 &lt; ../to-be-other_tree.patch
</span></span></code></pre></div>option explain:
<ul>
<li><code>-p&lt;num&gt;, --strip=num</code> Strip the smallest prefix containing num leading slashes
from each file name found in the patch file.</li>
</ul>
</li>
</ol>
<p>Note:</p>
<ul>
<li>the patch file shouldn&rsquo;t be saved in the current folder</li>
</ul>

  </div>
</div>



    
    
    

    
    <script src="/js/navigation-module.js"></script>
    
  </body>

</html>
