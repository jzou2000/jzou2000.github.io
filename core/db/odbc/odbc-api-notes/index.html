<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>My Hugo</title>
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/site.css">
    <script src="/js/nav.js"></script>

    

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



  </head>

<head>
  <meta charset="utf-8">
    <title>My Hugo</title>
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/site.css">
    <script src="/js/nav.js"></script>

  

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



</head>

<body>
    
 <div id="menu-container"></div>

 


    
  
<div class="van-content-container">
  <div id="index-container" class="van-content-index"></div>
  <div class="van-content">
    <h1>ODBC API Notes</h1>
    <h2 id="return-length">Return Length</h2>
<p>Unit of length parameters (both input and output) of ODBC API</p>
<ul>
<li>if the field is determined to be a string, the unit is character
<ul>
<li>SQLBrowseConnect, SQLConnect, SQLDriverConnect</li>
<li>SQLColumns, SQLProcedureColumns, SQLProcedures, SQLSpecialColumns, SQLTables</li>
<li>SQLColumnPrivileges, SQLForeignKeys, SQLPrimaryKeys, SQLStatistics, SQLTablePrivileges</li>
<li>SQLDataSources</li>
<li>SQLDescribeCol</li>
<li>SQLExecDirect, SQLPrepare, SQLNativeSql</li>
<li>SQLGetCursorName, SQLSetCursorName</li>
<li>SQLGetDescRec</li>
<li>SQLGetDiagRec</li>
<li>SQLGetTypeInfo (return a resultset)</li>
</ul>
</li>
<li>otherwise (even the buffer actually holds a string) the unit is byte
<ul>
<li>SQLColAttribute</li>
<li>SQLDrivers (description length is in char, attribute length is in byte)</li>
<li>SQLGetConnectAttr, SQLSetConnectAttr</li>
<li>SQLGetDescField, SQLSetDescField</li>
<li>SQLGetDiagField</li>
<li><strong>SQLGetInfo</strong>: exception: iodbc returns text length in <strong>char</strong></li>
<li>SQLGetStmtAttr, SQLSetStmtAttr (special: SQL_NTS, SQL_LEN_BINARY_ATTR, SQL_IS_POINTER, SQL_IS_INTEGER, SQL_IS_UINTEGER )</li>
</ul>
</li>
<li>the returned length of text excludes the terminal null character,
however the buffer should be able to hold the terminal null,
otherwise truncation happens.</li>
<li>Other APIs return character
<ul>
<li>SQLDescribeParam, ParameterSizePtr is in char. (there&rsquo;s no W-version though)</li>
</ul>
</li>
<li>SQLGetData/SQLPutData always use length in bytes</li>
</ul>

  </div>
</div>



    
    
    

    
    <script src="/js/menu-module.js"></script>
    <script src="/js/index-module.js"></script>
</body>
</html>
