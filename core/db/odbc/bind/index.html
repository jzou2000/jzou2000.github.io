<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<title>
    My Hugo
</title>

<link rel="stylesheet" type="text/css" href="/css/syntax.css">
<link rel="stylesheet" type="text/css" href="/css/site.css">

  



</head>

<body>
    
 
<div class="header">
  <div class="nav-menu-bar">
    <ul class="nav-menu-bar">
    
      <li class="nav-menu">
        
          Core
          <div class="nav-menu-item">
            
              

  
  
    <a href="/core/algorithm/resources/">Algorithm</a>
  


            
              

  
  
    
      <a href="/core/c&#43;&#43;/debug/sysinternals/">C/C&#43;&#43;</a>
    
  


            
              

  
  
    
      <a href="/core/db/odbc/odbc-api-notes/">Database</a>
    
  


            
              

  
  
    <a href="/core/docker/install/">Docker</a>
  


            
              

  
  
    
      <a href="/core/git/p4/p4recipe/">Git</a>
    
  


            
              

  
  
    <a href="/core/java/load-overload/">Java</a>
  


            
              

  
  
    <a href="/core/jenkins/overview/">Jenkins</a>
  


            
              

  
  
    
      <a href="/core/linux/utils/diff/">Linux</a>
    
  


            
              

  
  
    <a href="/core/misc/vsc/">Misc</a>
  


            
              

  
  
    <a href="/core/network/mitmproxy/">Network</a>
  


            
              

  
  
    <a href="/core/open-source/apache/">Open Source</a>
  


            
              

  
  
    <a href="/core/python/shallow-or-deep/">Python</a>
  


            
              

  
  
    
      <a href="/core/rosetta/container/vector/">Rosetta</a>
    
  


            
              

  
  
    <a href="/core/security/ssh-key/">Security</a>
  


            
              

  
  
    
      <a href="/core/shell/bash/array/">Shell</a>
    
  


            
          </div>
        
      </li>
    
      <li class="nav-menu">
        
          Web
          <div class="nav-menu-item">
            
              

  
  
    <a href="/web/css/align/">CSS</a>
  


            
              

  
  
    <a href="/web/html/overview/">Html</a>
  


            
              

  
  
    <a href="/web/hugo/my-hugo-docker/">Hugo</a>
  


            
              

  
  
    <a href="/web/js/vsc-settings-javascript/">JavaScript</a>
  


            
              

  
  
    <a href="/web/misc/tools/">Misc</a>
  


            
              

  
  
    
      <a href="/web/svg/samples/embed-svg/">SVG</a>
    
  


            
              

  
  
    <a href="/web/vue/vue-quick-start/">Vue</a>
  


            
          </div>
        
      </li>
    
      <li class="nav-menu">
        
          IoT
          <div class="nav-menu-item">
            
              

  
  
    <a href="/iot/arduino/shopping/">Arduino</a>
  


            
              

  
  
    
      <a href="/iot/electronics/audio/microphone-array/">Electroincs</a>
    
  


            
              

  
  
    <a href="/iot/esp/esp32/">Esp</a>
  


            
              

  
  
    <a href="/iot/freecad/online-resources/">FreeCAD</a>
  


            
              

  
  
    <a href="/iot/general/emulator/">General</a>
  


            
          </div>
        
      </li>
    
      <li class="nav-menu">
        
          Blogs
          <div class="nav-menu-item">
            
              

  
  
    <a href="/blogs/2023/04/">2023</a>
  


            
              

  
  
    <a href="/blogs/blood-tests/results/">Blood Tests</a>
  


            
              

  
  
    <a href="/blogs/cancer/calender/">Cancer</a>
  


            
              

  
  
    
      <a href="/blogs/english/proverbs-of-day/200/">English</a>
    
  


            
              

  
  
    <a href="/blogs/recipe/begrette/">Recipe</a>
  


            
              

  
  
    <a href="/blogs/camino/sjpdp/">The French Camino</a>
  


            
              

  
  
    <a href="/blogs/travels/morocco/">Travels</a>
  


            
              

  
  
    <a href="/blogs/vancouver/bookmark/">Vancouver</a>
  


            
              

  
  
    <a href="/blogs/varicose/intro/">Varicose Veins</a>
  


            
              

  
  
    <a href="/blogs/workout/bookmarks/">Workout</a>
  


            
          </div>
        
      </li>
    
    
      <li class="nav-menu">
          Taxonomies
          
<div class="nav-menu-item">
    
    <a href='/categories'>categories</a>
    
    <a href='/tags'>tags</a>
    
</div>

      </li>
    
    </ul>
  </div>
</div>



    
<div>
  
<div class="nav-sidebar">
  
  

  
    
  
  
  <div class='nav-sidebar-title'>Database</div>
  
    
      <label for="JDBC">JDBC</label>
      <input type="radio" name="nav-sidebar" id="JDBC" >
      <div class="nav-sidebar-cascade">
        
          <a href="/core/db/jdbc/jdbc-data-type/">JDBC Data Types</a>
        
      </div>
    
      <label for="NoSQL">NoSQL</label>
      <input type="radio" name="nav-sidebar" id="NoSQL" >
      <div class="nav-sidebar-cascade">
        
          <a href="/core/db/nosql/mongo/">MongoDB Cheatsheet</a>
        
      </div>
    
      <label for="ODBC">ODBC</label>
      <input type="radio" name="nav-sidebar" id="ODBC" checked>
      <div class="nav-sidebar-cascade">
        
          <a href="/core/db/odbc/bind/">bind</a>
        
          <a href="/core/db/odbc/build-unixodbc/">build unixodbc</a>
        
          <a href="/core/db/odbc/catalog/">catalog functions</a>
        
          <a href="/core/db/odbc/dm-info/">dm info</a>
        
          <a href="/core/db/odbc/odbc-api-notes/">odbc api notes</a>
        
          <a href="/core/db/odbc/odbc-config/">odbc config</a>
        
          <a href="/core/db/odbc/sql-to-c/">sql-to-c</a>
        
          <a href="/core/db/odbc/odbc-const/">sqlstate &amp; constants</a>
        
          <a href="/core/db/odbc/unixodbc-code-study/">unixodbc code study</a>
        
          <a href="/core/db/odbc/odbc-attr/">ODBC Attributes</a>
        
          <a href="/core/db/odbc/odbc-api/">ODBC API Cheatsheet</a>
        
          <a href="/core/db/odbc/odbc-data-type/">ODBC Data Types</a>
        
          <a href="/core/db/odbc/odbc-driver-manager/">ODBC Driver Manager</a>
        
      </div>
    
      <label for="postgres">postgres</label>
      <input type="radio" name="nav-sidebar" id="postgres" >
      <div class="nav-sidebar-cascade">
        
          <a href="/core/db/postgres/launch-by-docker/">launch-by-docker</a>
        
          <a href="/core/db/postgres/user/">postgresql user</a>
        
      </div>
    
      <label for="SQLite">SQLite</label>
      <input type="radio" name="nav-sidebar" id="SQLite" >
      <div class="nav-sidebar-cascade">
        
          <a href="/core/db/sqlite/build-sqlite/">build from source</a>
        
          <a href="/core/db/sqlite/sqlite-sys-table/">Sqlite System Tables</a>
        
      </div>
    
  

  
  <div class='nav-sidebar-direct'>
  
    
  
    
  
    
  
    
  
    
  
  </div>
  
</div>

  <div class="content">
  <h1>SQLBindCol and SQLBindParamter</h1>
  
  <table>
<thead>
<tr>
<th style="text-align:left">SQLBindCol</th>
<th style="text-align:left">SQLBindParameter</th>
<th style="text-align:left">Data Type</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">StatementHandle</td>
<td style="text-align:left">StatementHandle</td>
<td style="text-align:left">SQLHSTMT</td>
<td style="text-align:left">statement handle</td>
</tr>
<tr>
<td style="text-align:left">ColumnNumber</td>
<td style="text-align:left">ParameterNumber</td>
<td style="text-align:left">SQLUSMALLINT</td>
<td style="text-align:left">1-based column/parameter number</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">InputOutputType</td>
<td style="text-align:left">SQLSMALLINT</td>
<td style="text-align:left">input/output/input-output</td>
</tr>
<tr>
<td style="text-align:left">TargetType</td>
<td style="text-align:left">ValueType</td>
<td style="text-align:left">SQLSMALLINT</td>
<td style="text-align:left">c-type-id</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">ParameterType</td>
<td style="text-align:left">SQLSMALLINT</td>
<td style="text-align:left">sql-type-id</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">ColumnSize</td>
<td style="text-align:left">SQLULEN</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">DecimalDigits</td>
<td style="text-align:left">SQLSMALLINT</td>
<td style="text-align:left">aka scale</td>
</tr>
<tr>
<td style="text-align:left">TargetValuePtr</td>
<td style="text-align:left">ParameterValuePtr</td>
<td style="text-align:left">SQLPOINTER</td>
<td style="text-align:left">buffer to receive(col)/offer(param) value</td>
</tr>
<tr>
<td style="text-align:left">BufferLength</td>
<td style="text-align:left">BufferLength</td>
<td style="text-align:left">SQLLEN</td>
<td style="text-align:left">size of buffer</td>
</tr>
<tr>
<td style="text-align:left">StrLen_or_IndPtr</td>
<td style="text-align:left">StrLen_or_IndPtr</td>
<td style="text-align:left">SQLLEN *</td>
<td style="text-align:left">input/output actual data length</td>
</tr>
</tbody>
</table>
<ul>
<li>StrLen_or_IndPtr
<ul>
<li>length of data</li>
<li>SQL_NTS</li>
<li>SQL_NULL_DATA</li>
<li>SQL_DATA_AT_EXEC</li>
<li>SQL_LEN_DATA_AT_EXEC macro</li>
<li>SQL_COLUMN_IGNORE</li>
</ul>
</li>
</ul>
<h3 id="extra-statement-attributes">Extra statement attributes</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Attribute</th>
<th style="text-align:left">Type</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">SQL_ATTR_ROW_BIND_TYPE</td>
<td style="text-align:left">SQLULEN</td>
<td style="text-align:left">SQL_BIND_BY_COLUMN(0, default) for column-wise or row-size for row-wise</td>
</tr>
<tr>
<td style="text-align:left">SQL_ATTR_ROW_ARRAY_SIZE</td>
<td style="text-align:left">SQLULEN</td>
<td style="text-align:left">array size (of rows), default 1</td>
</tr>
<tr>
<td style="text-align:left">SQL_ATTR_ROWS_FETCHED_PTR</td>
<td style="text-align:left">SQLULEN*</td>
<td style="text-align:left">in last fetch (and like), number of rows that are actually fetched</td>
</tr>
<tr>
<td style="text-align:left">SQL_ATTR_ROW_STATUS_PTR</td>
<td style="text-align:left">SQLUSMALLINT*</td>
<td style="text-align:left">an array of SQLUSMALLINT for each row of fetched</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">SQL_ATTR_PARAMSET_SIZE</td>
<td style="text-align:left">SQLULEN</td>
<td style="text-align:left">array size (of parameters), default 1</td>
</tr>
<tr>
<td style="text-align:left">SQL_ATTR_PARAMS_PROCESSED_PTR</td>
<td style="text-align:left">SQLULEN*</td>
<td style="text-align:left">number of rows of processed parameter</td>
</tr>
</tbody>
</table>
<h3 id="row-status-array-sqlbindcol">Row status array (SQLBindCol)</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">SQL_ROW_SUCCESS</td>
<td style="text-align:left">The row was successfully fetched and has not changed since it was last fetched from this result set.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_SUCCESS_WITH_INFO</td>
<td style="text-align:left">The row was successfully fetched and has not changed since it was last fetched from this result set. However, a warning was returned about the row.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_ERROR</td>
<td style="text-align:left">An error occurred while fetching the row.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_UPDATED</td>
<td style="text-align:left">The row was successfully fetched and has changed since it was last fetched from this result set. If the row is fetched again from this result set or is refreshed by SQLSetPos, the status is changed to the row&rsquo;s new status.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_DELETED</td>
<td style="text-align:left">The row has been deleted since it was last fetched from this result set.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_ADDED</td>
<td style="text-align:left">The row was inserted by SQLBulkOperations. If the row is fetched again from this result set or is refreshed by SQLSetPos, its status is SQL_ROW_SUCCESS.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_NOROW</td>
<td style="text-align:left">The rowset overlapped the end of the result set, and no row was returned that corresponded to this element of the row status array.</td>
</tr>
</tbody>
</table>
<h3 id="data-at-execution-sqlbindparameter">Data-at-Execution (SQLBindParameter)</h3>
<p>If StrLen_or_IndPtr is SQL_DATA_AT_EXEC or SQL_LEN_DATA_AT_EXEC(length) macro, <code>SQLExecDirect()</code> or <code>SQLExecute()</code> returns <strong>SQL_NEED_DATA</strong>
to request the application to offer data with <code>SQLPutData</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#define SQL_LEN_DATA_AT_EXEC_OFFSET  (-100)
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SQL_LEN_DATA_AT_EXEC(length) (-(length)+SQL_LEN_DATA_AT_EXEC_OFFSET)
</span></span></span></code></pre></div><p>The order of parameter of DAE is not guarenteed, the parameter number is returned by <code>SQLParamData()</code> of <code>ParameterValuePtr</code>.
To make the process easier, it is a common practice to pass a <strong>parameter-token</strong> (such as parameter sequence number) instead of a real pointer (because the pointer is not used) in <code>SQLBindParameter()</code>. Row number is determined by <code>SQL_ATTR_PARAMS_PROCESSED_PTR</code>.</p>


</div>
</div>

    
    
    
</body>
</html>
