<!DOCTYPE html>
<html lang="en">




  <head>
    <meta charset="utf-8">
<title>My Hugo</title>
<link rel="stylesheet" type="text/css" href="/css/syntax.css">
<link rel="stylesheet" type="text/css" href="/css/site.css">
<script src="/js/nav.js"></script>

    

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



  </head>

  <body>
    
 <div id="menu-container"></div>

 


    
  
<div class="van-content-container">
  <div id="index-container" class="van-content-index"></div>
  <div class="van-content">
    <h1>SQLBindCol and SQLBindParamter</h1>
    <table>
<thead>
<tr>
<th style="text-align:left">SQLBindCol</th>
<th style="text-align:left">SQLBindParameter</th>
<th style="text-align:left">Data Type</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">StatementHandle</td>
<td style="text-align:left">StatementHandle</td>
<td style="text-align:left">SQLHSTMT</td>
<td style="text-align:left">statement handle</td>
</tr>
<tr>
<td style="text-align:left">ColumnNumber</td>
<td style="text-align:left">ParameterNumber</td>
<td style="text-align:left">SQLUSMALLINT</td>
<td style="text-align:left">1-based column/parameter number</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">InputOutputType</td>
<td style="text-align:left">SQLSMALLINT</td>
<td style="text-align:left">input/output/input-output</td>
</tr>
<tr>
<td style="text-align:left">TargetType</td>
<td style="text-align:left">ValueType</td>
<td style="text-align:left">SQLSMALLINT</td>
<td style="text-align:left">c-type-id</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">ParameterType</td>
<td style="text-align:left">SQLSMALLINT</td>
<td style="text-align:left">sql-type-id</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">ColumnSize</td>
<td style="text-align:left">SQLULEN</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">DecimalDigits</td>
<td style="text-align:left">SQLSMALLINT</td>
<td style="text-align:left">aka scale</td>
</tr>
<tr>
<td style="text-align:left">TargetValuePtr</td>
<td style="text-align:left">ParameterValuePtr</td>
<td style="text-align:left">SQLPOINTER</td>
<td style="text-align:left">buffer to receive(col)/offer(param) value</td>
</tr>
<tr>
<td style="text-align:left">BufferLength</td>
<td style="text-align:left">BufferLength</td>
<td style="text-align:left">SQLLEN</td>
<td style="text-align:left">size of buffer</td>
</tr>
<tr>
<td style="text-align:left">StrLen_or_IndPtr</td>
<td style="text-align:left">StrLen_or_IndPtr</td>
<td style="text-align:left">SQLLEN *</td>
<td style="text-align:left">input/output actual data length</td>
</tr>
</tbody>
</table>
<ul>
<li>StrLen_or_IndPtr
<ul>
<li>length of data</li>
<li>SQL_NTS</li>
<li>SQL_NULL_DATA</li>
<li>SQL_DATA_AT_EXEC</li>
<li>SQL_LEN_DATA_AT_EXEC macro</li>
<li>SQL_COLUMN_IGNORE</li>
</ul>
</li>
</ul>
<h3 id="extra-statement-attributes">Extra statement attributes</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Attribute</th>
<th style="text-align:left">Type</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">SQL_ATTR_ROW_BIND_TYPE</td>
<td style="text-align:left">SQLULEN</td>
<td style="text-align:left">SQL_BIND_BY_COLUMN(0, default) for column-wise or row-size for row-wise</td>
</tr>
<tr>
<td style="text-align:left">SQL_ATTR_ROW_ARRAY_SIZE</td>
<td style="text-align:left">SQLULEN</td>
<td style="text-align:left">array size (of rows), default 1</td>
</tr>
<tr>
<td style="text-align:left">SQL_ATTR_ROWS_FETCHED_PTR</td>
<td style="text-align:left">SQLULEN*</td>
<td style="text-align:left">in last fetch (and like), number of rows that are actually fetched</td>
</tr>
<tr>
<td style="text-align:left">SQL_ATTR_ROW_STATUS_PTR</td>
<td style="text-align:left">SQLUSMALLINT*</td>
<td style="text-align:left">an array of SQLUSMALLINT for each row of fetched</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">SQL_ATTR_PARAMSET_SIZE</td>
<td style="text-align:left">SQLULEN</td>
<td style="text-align:left">array size (of parameters), default 1</td>
</tr>
<tr>
<td style="text-align:left">SQL_ATTR_PARAMS_PROCESSED_PTR</td>
<td style="text-align:left">SQLULEN*</td>
<td style="text-align:left">number of rows of processed parameter</td>
</tr>
</tbody>
</table>
<h3 id="row-status-array-sqlbindcol">Row status array (SQLBindCol)</h3>
<table>
<thead>
<tr>
<th style="text-align:left">Value</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">SQL_ROW_SUCCESS</td>
<td style="text-align:left">The row was successfully fetched and has not changed since it was last fetched from this result set.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_SUCCESS_WITH_INFO</td>
<td style="text-align:left">The row was successfully fetched and has not changed since it was last fetched from this result set. However, a warning was returned about the row.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_ERROR</td>
<td style="text-align:left">An error occurred while fetching the row.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_UPDATED</td>
<td style="text-align:left">The row was successfully fetched and has changed since it was last fetched from this result set. If the row is fetched again from this result set or is refreshed by SQLSetPos, the status is changed to the row&rsquo;s new status.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_DELETED</td>
<td style="text-align:left">The row has been deleted since it was last fetched from this result set.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_ADDED</td>
<td style="text-align:left">The row was inserted by SQLBulkOperations. If the row is fetched again from this result set or is refreshed by SQLSetPos, its status is SQL_ROW_SUCCESS.</td>
</tr>
<tr>
<td style="text-align:left">SQL_ROW_NOROW</td>
<td style="text-align:left">The rowset overlapped the end of the result set, and no row was returned that corresponded to this element of the row status array.</td>
</tr>
</tbody>
</table>
<h3 id="data-at-execution-sqlbindparameter">Data-at-Execution (SQLBindParameter)</h3>
<p>If StrLen_or_IndPtr is SQL_DATA_AT_EXEC or SQL_LEN_DATA_AT_EXEC(length) macro, <code>SQLExecDirect()</code> or <code>SQLExecute()</code> returns <strong>SQL_NEED_DATA</strong>
to request the application to offer data with <code>SQLPutData</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#define SQL_LEN_DATA_AT_EXEC_OFFSET  (-100)
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SQL_LEN_DATA_AT_EXEC(length) (-(length)+SQL_LEN_DATA_AT_EXEC_OFFSET)
</span></span></span></code></pre></div><p>The order of parameter of DAE is not guarenteed, the parameter number is returned by <code>SQLParamData()</code> of <code>ParameterValuePtr</code>.
To make the process easier, it is a common practice to pass a <strong>parameter-token</strong> (such as parameter sequence number) instead of a real pointer (because the pointer is not used) in <code>SQLBindParameter()</code>. Row number is determined by <code>SQL_ATTR_PARAMS_PROCESSED_PTR</code>.</p>

  </div>
</div>



    
    
    

    
    <script src="/js/menu-module.js"></script>
    <script src="/js/index-module.js"></script>
  </body>

</html>
