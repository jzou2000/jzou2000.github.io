<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>My Hugo</title>
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/site.css">
    <script src="/js/nav.js"></script>

    

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



  </head>

<head>
  <meta charset="utf-8">
    <title>My Hugo</title>
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/site.css">
    <script src="/js/nav.js"></script>

  

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



</head>

<body>
    
 <div id="menu-container"></div>

 


    
  
<div class="van-content-container">
  <div id="index-container" class="van-content-index"></div>
  <div class="van-content">
    <h1>Template Variadic</h1>
    <h2 id="variable-arguments">Variable Arguments</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;cstdlib&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//----------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">// function sum accept any number of args, add (operator+) them together
</span></span></span><span class="line"><span class="cl"><span class="c1">//-----------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">// recurisve stopper
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">T</span> <span class="n">sum</span><span class="p">(</span><span class="n">T</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// recursive calls
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">Args</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">T</span> <span class="n">sum</span><span class="p">(</span><span class="n">T</span> <span class="n">first</span><span class="p">,</span> <span class="n">Args</span><span class="p">...</span><span class="n">args</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">first</span> <span class="o">+</span> <span class="n">sum</span><span class="p">(</span><span class="n">args</span><span class="p">...);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//----------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">// get environment variable, with fallback names
</span></span></span><span class="line"><span class="cl"><span class="c1">//-----------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">// recursive stopper
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">env</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">getenv</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// recursive calls
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span> <span class="n">Args</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">env</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">prime</span><span class="p">,</span> <span class="n">Args</span><span class="p">...</span> <span class="n">args</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">value</span> <span class="o">=</span> <span class="n">env</span><span class="p">(</span><span class="n">prime</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">return</span> <span class="n">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">env</span><span class="p">(</span><span class="n">args</span><span class="p">...);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">args</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 1+2+3+4=4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;sum=&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// get env ME, or GOOD, or USER
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;env=&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">env</span><span class="p">(</span><span class="s">&#34;ME&#34;</span><span class="p">,</span> <span class="s">&#34;GOOD&#34;</span><span class="p">,</span> <span class="s">&#34;USER&#34;</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Build and run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">jasonz@VANLWIN0056:~/codex/cpp$ make ex-templ-var-args
</span></span><span class="line"><span class="cl">g++ -g -I. -std<span class="o">=</span>c++11   -c -o ex-templ-var-args.o ex-templ-var-args.cpp
</span></span><span class="line"><span class="cl">g++ -o ex-templ-var-args ex-templ-var-args.o
</span></span><span class="line"><span class="cl">jasonz@VANLWIN0056:~/codex/cpp$ ./ex-templ-var-args
</span></span><span class="line"><span class="cl"><span class="nv">sum</span><span class="o">=</span><span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nv">env</span><span class="o">=</span>jasonz
</span></span><span class="line"><span class="cl">jasonz@VANLWIN0056:~/codex/cpp$ <span class="nv">ME</span><span class="o">=</span>zou ./ex-templ-var-args
</span></span><span class="line"><span class="cl"><span class="nv">sum</span><span class="o">=</span><span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nv">env</span><span class="o">=</span>zou
</span></span><span class="line"><span class="cl">jasonz@VANLWIN0056:~/codex/cpp$ <span class="nv">ME</span><span class="o">=</span>zou <span class="nv">GOOD</span><span class="o">=</span>zj ./ex-templ-var-args
</span></span><span class="line"><span class="cl"><span class="nv">sum</span><span class="o">=</span><span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nv">env</span><span class="o">=</span>zou
</span></span><span class="line"><span class="cl">jasonz@VANLWIN0056:~/codex/cpp$ <span class="nv">ME</span><span class="o">=</span> <span class="nv">GOOD</span><span class="o">=</span>zj ./ex-templ-var-args
</span></span><span class="line"><span class="cl"><span class="nv">sum</span><span class="o">=</span><span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nv">env</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">jasonz@VANLWIN0056:~/codex/cpp$  <span class="nv">GOOD</span><span class="o">=</span>zj ./ex-templ-var-args
</span></span><span class="line"><span class="cl"><span class="nv">sum</span><span class="o">=</span><span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nv">env</span><span class="o">=</span>zj
</span></span><span class="line"><span class="cl">jasonz@VANLWIN0056:~/codex/cpp$   ./ex-templ-var-args
</span></span><span class="line"><span class="cl"><span class="nv">sum</span><span class="o">=</span><span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nv">env</span><span class="o">=</span>jasonz
</span></span></code></pre></div><p>Note:</p>
<ul>
<li>C++ compiler actually instantiates template recursively
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">jasonz@VANLWIN0056:~/codex/cpp$ nm ex-templ-var-args
</span></span><span class="line"><span class="cl">jasonz@VANLWIN0056:~/codex/cpp$ nm ex-templ-var-args <span class="p">|</span> c++filt
</span></span><span class="line"><span class="cl">... <span class="o">(</span>omitted<span class="o">)</span>
</span></span><span class="line"><span class="cl">00000000000013d2 W char const* env&lt;char const*&gt;<span class="o">(</span>char const*, char const*<span class="o">)</span>
</span></span><span class="line"><span class="cl">000000000000135c W char const* env&lt;char const*, char const*&gt;<span class="o">(</span>char const*, char const*, char const*<span class="o">)</span>
</span></span><span class="line"><span class="cl">00000000000011e9 T env<span class="o">(</span>char const*<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">0000000000001435</span> W int sum&lt;int&gt;<span class="o">(</span>int<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">0000000000001412</span> W int sum&lt;int, int&gt;<span class="o">(</span>int, int<span class="o">)</span>
</span></span><span class="line"><span class="cl">00000000000013a7 W int sum&lt;int, int, int&gt;<span class="o">(</span>int, int, int<span class="o">)</span>
</span></span><span class="line"><span class="cl">000000000000132b W int sum&lt;int, int, int, int&gt;<span class="o">(</span>int, int, int, int<span class="o">)</span>
</span></span><span class="line"><span class="cl">00000000000012c5 t __static_initialization_and_destruction_0<span class="o">(</span>int, int<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">0000000000001207</span> T main
</span></span><span class="line"><span class="cl">... <span class="o">(</span>omitted<span class="o">)</span>
</span></span></code></pre></div></li>
</ul>

  </div>
</div>



    
    
    

    
    <script src="/js/menu-module.js"></script>
    <script src="/js/index-module.js"></script>
</body>
</html>
