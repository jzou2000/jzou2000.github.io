<!DOCTYPE html>
<html lang="en">




  <head>
    <meta charset="utf-8">
<title>My Hugo</title>
<link rel="stylesheet" type="text/css" href="/css/syntax.css">
<link rel="stylesheet" type="text/css" href="/css/site.css">
<script src="/js/nav.js"></script>

    

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



  </head>

  <body>
    
 <div id="menu-container"></div>

 


    
  
<div class="van-content-container">
  <div id="index-container" class="van-content-index"></div>
  <div class="van-content">
    <h1>casting</h1>
    <h2 id="solaris-issue">solaris issue</h2>
<p>app.cpp
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">foo</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">v1</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">v2</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;v1=&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">v1</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, v2=&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">v2</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, msg=&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">msg</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">bar</span><span class="p">(</span><span class="n">T</span> <span class="n">v1</span><span class="p">,</span> <span class="n">T</span> <span class="n">v2</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;v1=&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">v1</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, v2=&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">v2</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, msg=&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">msg</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">ptr</span><span class="p">(</span><span class="n">T</span><span class="o">*</span> <span class="n">v1</span><span class="p">,</span> <span class="n">T</span><span class="o">*</span> <span class="n">v2</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;v1=&#34;</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">v1</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, v2=&#34;</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">v2</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;, msg=&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">msg</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;start&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="n">fail</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;&amp;fail=&#34;</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">fail</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">foo</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">fail</span><span class="p">,</span> <span class="s">&#34;this is a test ref&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">bar</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">fail</span><span class="p">,</span> <span class="s">&#34;this is a test val&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ptr</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fail</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">fail</span><span class="p">,</span> <span class="s">&#34;this is a test ptr&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;end&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>with gcc 4.9.2</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">-bash-3.2$ g++ -o app -g app.cpp
</span></span><span class="line"><span class="cl">-bash-3.2$ dbx app
</span></span><span class="line"><span class="cl">For information about new features see <span class="sb">`</span><span class="nb">help</span> changes<span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">To remove this message, put `dbxenv suppress_startup_message 8.0&#39;</span> in your .dbxrc
</span></span><span class="line"><span class="cl">Reading app
</span></span><span class="line"><span class="cl">Reading ld.so.1
</span></span><span class="line"><span class="cl">Reading libstdc++.so.6.0.20
</span></span><span class="line"><span class="cl">Reading libm.so.2
</span></span><span class="line"><span class="cl">Reading librt.so.1
</span></span><span class="line"><span class="cl">Reading libgcc_s.so.1
</span></span><span class="line"><span class="cl">Reading libc.so.1
</span></span><span class="line"><span class="cl">Reading libaio.so.1
</span></span><span class="line"><span class="cl">Reading libmd.so.1
</span></span><span class="line"><span class="cl"><span class="o">(</span>dbx<span class="o">)</span> stop at <span class="m">8</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>2<span class="o">)</span> stop at <span class="s2">&#34;app.cpp&#34;</span>:8
</span></span><span class="line"><span class="cl"><span class="o">(</span>dbx<span class="o">)</span> stop at <span class="m">14</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>3<span class="o">)</span> stop at <span class="s2">&#34;app.cpp&#34;</span>:14
</span></span><span class="line"><span class="cl"><span class="o">(</span>dbx<span class="o">)</span> stop at <span class="m">20</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>4<span class="o">)</span> stop at <span class="s2">&#34;app.cpp&#34;</span>:20
</span></span><span class="line"><span class="cl"><span class="o">(</span>dbx<span class="o">)</span> run
</span></span><span class="line"><span class="cl">Running: app 
</span></span><span class="line"><span class="cl"><span class="o">(</span>process id 2058<span class="o">)</span>
</span></span><span class="line"><span class="cl">Reading libc_psr.so.1
</span></span><span class="line"><span class="cl">start
</span></span><span class="line"><span class="cl"><span class="p">&amp;</span><span class="nv">fail</span><span class="o">=</span>0xffbffa58
</span></span><span class="line"><span class="cl">stopped in foo&lt;unsigned&gt; at line <span class="m">8</span> in file <span class="s2">&#34;app.cpp&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="m">8</span>       cout &lt;&lt; <span class="s2">&#34;v1=&#34;</span> <span class="s">&lt;&lt; v1 &lt;&lt; &#34;, v2=&#34; &lt;&lt; v2 &lt;&lt; &#34;, msg=&#34; &lt;&lt; msg &lt;&lt; endl;
</span></span></span><span class="line"><span class="cl"><span class="s">(dbx) where
</span></span></span><span class="line"><span class="cl"><span class="s">=&gt;[1] foo&lt;unsigned&gt;(v1</span> <span class="o">=</span> 1U, <span class="nv">v2</span> <span class="o">=</span> 0, <span class="nv">msg</span> <span class="o">=</span> 0x11298 <span class="s2">&#34;this is a test ref&#34;</span><span class="o">)</span>, line <span class="m">8</span> in <span class="s2">&#34;app.cpp&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>2<span class="o">]</span> main<span class="o">()</span>, line <span class="m">28</span> in <span class="s2">&#34;app.cpp&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>dbx<span class="o">)</span> c
</span></span><span class="line"><span class="cl">c: not found
</span></span><span class="line"><span class="cl"><span class="o">(</span>dbx<span class="o">)</span> cont
</span></span><span class="line"><span class="cl"><span class="nv">v1</span><span class="o">=</span>1, <span class="nv">v2</span><span class="o">=</span>0, <span class="nv">msg</span><span class="o">=</span>this is a <span class="nb">test</span> ref
</span></span><span class="line"><span class="cl">stopped in bar&lt;unsigned&gt; at line <span class="m">14</span> in file <span class="s2">&#34;app.cpp&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="m">14</span>       cout &lt;&lt; <span class="s2">&#34;v1=&#34;</span> <span class="s">&lt;&lt; v1 &lt;&lt; &#34;, v2=&#34; &lt;&lt; v2 &lt;&lt; &#34;, msg=&#34; &lt;&lt; msg &lt;&lt; endl;
</span></span></span><span class="line"><span class="cl"><span class="s">(dbx) where
</span></span></span><span class="line"><span class="cl"><span class="s">=&gt;[1] bar&lt;unsigned&gt;(v1</span> <span class="o">=</span> 1U, <span class="nv">v2</span> <span class="o">=</span> 0, <span class="nv">msg</span> <span class="o">=</span> 0x112b0 <span class="s2">&#34;this is a test val&#34;</span><span class="o">)</span>, line <span class="m">14</span> in <span class="s2">&#34;app.cpp&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>2<span class="o">]</span> main<span class="o">()</span>, line <span class="m">29</span> in <span class="s2">&#34;app.cpp&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>dbx<span class="o">)</span> cont
</span></span><span class="line"><span class="cl"><span class="nv">v1</span><span class="o">=</span>1, <span class="nv">v2</span><span class="o">=</span>0, <span class="nv">msg</span><span class="o">=</span>this is a <span class="nb">test</span> val
</span></span><span class="line"><span class="cl">stopped in ptr&lt;unsigned&gt; at line <span class="m">20</span> in file <span class="s2">&#34;app.cpp&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="m">20</span>       cout &lt;&lt; <span class="s2">&#34;v1=&#34;</span> &lt;&lt; *v1 &lt;&lt; <span class="s2">&#34;, v2=&#34;</span> &lt;&lt; *v2 &lt;&lt; <span class="s2">&#34;, msg=&#34;</span> <span class="s">&lt;&lt; msg &lt;&lt; endl;
</span></span></span><span class="line"><span class="cl"><span class="s">(dbx) where
</span></span></span><span class="line"><span class="cl"><span class="s">=&gt;[1] ptr&lt;unsigned&gt;(v1 = 0xffbffa58, v2 = 0xffbffa58, msg</span> <span class="o">=</span> 0x112c8 <span class="s2">&#34;this is a test ptr&#34;</span><span class="o">)</span>, line <span class="m">20</span> in <span class="s2">&#34;app.cpp&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>2<span class="o">]</span> main<span class="o">()</span>, line <span class="m">30</span> in <span class="s2">&#34;app.cpp&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>dbx<span class="o">)</span> 
</span></span></code></pre></div><p>gdb on linux</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> <span class="nb">break</span> <span class="m">8</span>
</span></span><span class="line"><span class="cl">Breakpoint <span class="m">1</span> at 0xb46: file app.cpp, line 8.
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> run
</span></span><span class="line"><span class="cl">Starting program: /mnt/huge/jzou/codex/mk/cast/app 
</span></span><span class="line"><span class="cl">start
</span></span><span class="line"><span class="cl"><span class="p">&amp;</span><span class="nv">fail</span><span class="o">=</span>0x7fffffffe118
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Breakpoint 1, foo&lt;unsigned int&gt; <span class="o">(</span><span class="nv">v1</span><span class="o">=</span>@0x7fffffffe11c: 1, <span class="nv">v2</span><span class="o">=</span>@0x7fffffffe118: 0, 
</span></span><span class="line"><span class="cl">    <span class="nv">msg</span><span class="o">=</span>0x555555554d92 <span class="s2">&#34;this is a test ref&#34;</span><span class="o">)</span> at app.cpp:8
</span></span><span class="line"><span class="cl">8	    cout &lt;&lt; <span class="s2">&#34;v1=&#34;</span> <span class="s">&lt;&lt; v1 &lt;&lt; &#34;, v2=&#34; &lt;&lt; v2 &lt;&lt; &#34;, msg=&#34; &lt;&lt; msg &lt;&lt; endl;
</span></span></span><span class="line"><span class="cl"><span class="s">(gdb) b 14
</span></span></span><span class="line"><span class="cl"><span class="s">Breakpoint 2 at 0x555555554bdc: file app.cpp, line 14.
</span></span></span><span class="line"><span class="cl"><span class="s">(gdb) b 20
</span></span></span><span class="line"><span class="cl"><span class="s">Breakpoint 3 at 0x555555554c6e: file app.cpp, line 20.
</span></span></span><span class="line"><span class="cl"><span class="s">(gdb) c
</span></span></span><span class="line"><span class="cl"><span class="s">Continuing.
</span></span></span><span class="line"><span class="cl"><span class="s">v1</span><span class="o">=</span>1, <span class="nv">v2</span><span class="o">=</span>0, <span class="nv">msg</span><span class="o">=</span>this is a <span class="nb">test</span> ref
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Breakpoint 2, bar&lt;unsigned int&gt; <span class="o">(</span><span class="nv">v1</span><span class="o">=</span>1, <span class="nv">v2</span><span class="o">=</span>0, 
</span></span><span class="line"><span class="cl">    <span class="nv">msg</span><span class="o">=</span>0x555555554da5 <span class="s2">&#34;this is a test val&#34;</span><span class="o">)</span> at app.cpp:14
</span></span><span class="line"><span class="cl">14	    cout &lt;&lt; <span class="s2">&#34;v1=&#34;</span> <span class="s">&lt;&lt; v1 &lt;&lt; &#34;, v2=&#34; &lt;&lt; v2 &lt;&lt; &#34;, msg=&#34; &lt;&lt; msg &lt;&lt; endl;
</span></span></span><span class="line"><span class="cl"><span class="s">(gdb) c
</span></span></span><span class="line"><span class="cl"><span class="s">Continuing.
</span></span></span><span class="line"><span class="cl"><span class="s">v1</span><span class="o">=</span>1, <span class="nv">v2</span><span class="o">=</span>0, <span class="nv">msg</span><span class="o">=</span>this is a <span class="nb">test</span> val
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Breakpoint 3, ptr&lt;unsigned int&gt; <span class="o">(</span><span class="nv">v1</span><span class="o">=</span>0x7fffffffe118, <span class="nv">v2</span><span class="o">=</span>0x7fffffffe118, 
</span></span><span class="line"><span class="cl">    <span class="nv">msg</span><span class="o">=</span>0x555555554db8 <span class="s2">&#34;this is a test ptr&#34;</span><span class="o">)</span> at app.cpp:20
</span></span><span class="line"><span class="cl">20	    cout &lt;&lt; <span class="s2">&#34;v1=&#34;</span> &lt;&lt; *v1 &lt;&lt; <span class="s2">&#34;, v2=&#34;</span> &lt;&lt; *v2 &lt;&lt; <span class="s2">&#34;, msg=&#34;</span> &lt;&lt; msg &lt;&lt; endl<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>gdb<span class="o">)</span> 
</span></span></code></pre></div>
  </div>
</div>



    
    
    

    
    <script src="/js/navigation-module.js"></script>
    
  </body>

</html>
