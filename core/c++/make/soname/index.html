<!DOCTYPE html>
<html lang="en">




  <head>
    <meta charset="utf-8">
<title>My Hugo</title>
<link rel="stylesheet" type="text/css" href="/css/syntax.css">
<link rel="stylesheet" type="text/css" href="/css/site.css">
<script src="/js/nav.js"></script>

    

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



  </head>

  <body>
    
 <div id="menu-container"></div>

 


    
  
<div class="van-content-container">
  <div id="index-container" class="van-content-index"></div>
  <div class="van-content">
    <h1>Shared Object and soname</h1>
    <h2 id="useful-command">Useful command</h2>
<ul>
<li>objdump - display information from object files</li>
<li>nm - list symbols from object files</li>
</ul>
<h3 id="objdump">objdump</h3>
<table>
<thead>
<tr>
<th>option</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-p,&ndash;private-headers</td>
<td>needed for showing SONAME, dependencies, etc</td>
</tr>
<tr>
<td>-t,&ndash;syms</td>
<td>symbols</td>
</tr>
<tr>
<td>-C,&ndash;demangle</td>
<td>demangle C++ names</td>
</tr>
</tbody>
</table>
<h2 id="soname">SONAME</h2>
<p>SONAME is the &rsquo;logical&rsquo; name of a shared object, which is saved in the target binary when it is linked with a .so file, i.e. the linker use <code>libname.so</code> to resolve <code>-lname</code> and write its soname in the target file. When the target is executed, the dl loader use the soname to locate the shared object.</p>
<p>Use this option to set soname for the linker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">$(</span>LD<span class="k">)</span> -Wl,-soname,<span class="k">$(</span>the_name<span class="k">)</span> -o <span class="nv">$@</span> $^ -lname
</span></span></code></pre></div><p>Note:
llvm linker uses different option name for this</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># for clang/llvm</span>
</span></span><span class="line"><span class="cl"><span class="k">$(</span>LD<span class="k">)</span> -Wl,-install_name,<span class="k">$(</span>the_name<span class="k">)</span> -o <span class="nv">$@</span> $^ -lname
</span></span></code></pre></div><p>Following is an example to show soname and dependencies of a shared object</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ objdump -p libzdm.so
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">libzdm.so:     file format elf64-x86-64
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Program Header:
</span></span><span class="line"><span class="cl">    LOAD off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**21
</span></span><span class="line"><span class="cl">         filesz 0x000000000000509c memsz 0x000000000000509c flags r-x
</span></span><span class="line"><span class="cl">    LOAD off    0x0000000000005dd0 vaddr 0x0000000000205dd0 paddr 0x0000000000205dd0 align 2**21
</span></span><span class="line"><span class="cl">         filesz 0x0000000000000250 memsz 0x0000000000000258 flags rw-
</span></span><span class="line"><span class="cl"> DYNAMIC off    0x0000000000005de8 vaddr 0x0000000000205de8 paddr 0x0000000000205de8 align 2**3
</span></span><span class="line"><span class="cl">         filesz 0x00000000000001f0 memsz 0x00000000000001f0 flags rw-
</span></span><span class="line"><span class="cl">    NOTE off    0x00000000000001c8 vaddr 0x00000000000001c8 paddr 0x00000000000001c8 align 2**2
</span></span><span class="line"><span class="cl">         filesz 0x0000000000000024 memsz 0x0000000000000024 flags r--
</span></span><span class="line"><span class="cl">EH_FRAME off    0x0000000000003888 vaddr 0x0000000000003888 paddr 0x0000000000003888 align 2**2
</span></span><span class="line"><span class="cl">         filesz 0x00000000000004d4 memsz 0x00000000000004d4 flags r--
</span></span><span class="line"><span class="cl">   STACK off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**4
</span></span><span class="line"><span class="cl">         filesz 0x0000000000000000 memsz 0x0000000000000000 flags rw-
</span></span><span class="line"><span class="cl">   RELRO off    0x0000000000005dd0 vaddr 0x0000000000205dd0 paddr 0x0000000000205dd0 align 2**0
</span></span><span class="line"><span class="cl">         filesz 0x0000000000000230 memsz 0x0000000000000230 flags r--
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Dynamic Section:
</span></span><span class="line"><span class="cl">  NEEDED               libpthread.so.0
</span></span><span class="line"><span class="cl">  NEEDED               libdl.so.2
</span></span><span class="line"><span class="cl">  NEEDED               libstdc++.so.6
</span></span><span class="line"><span class="cl">  NEEDED               libm.so.6
</span></span><span class="line"><span class="cl">  NEEDED               libgcc_s.so.1
</span></span><span class="line"><span class="cl">  NEEDED               libc.so.6
</span></span><span class="line"><span class="cl">  SONAME               libodbc.so
</span></span><span class="line"><span class="cl">  INIT                 0x0000000000002258
</span></span><span class="line"><span class="cl">  FINI                 0x000000000000387c
</span></span><span class="line"><span class="cl">  INIT_ARRAY           0x0000000000205dd0
</span></span><span class="line"><span class="cl">  INIT_ARRAYSZ         0x0000000000000008
</span></span><span class="line"><span class="cl">  FINI_ARRAY           0x0000000000205dd8
</span></span><span class="line"><span class="cl">  FINI_ARRAYSZ         0x0000000000000008
</span></span><span class="line"><span class="cl">  GNU_HASH             0x00000000000001f0
</span></span><span class="line"><span class="cl">  STRTAB               0x0000000000001630
</span></span><span class="line"><span class="cl">  SYMTAB               0x0000000000000700
</span></span><span class="line"><span class="cl">  STRSZ                0x00000000000009fe
</span></span><span class="line"><span class="cl">  SYMENT               0x0000000000000018
</span></span><span class="line"><span class="cl">  PLTGOT               0x0000000000206000
</span></span><span class="line"><span class="cl">  RELA                 0x0000000000002198
</span></span><span class="line"><span class="cl">  RELASZ               0x00000000000000c0
</span></span><span class="line"><span class="cl">  RELAENT              0x0000000000000018
</span></span><span class="line"><span class="cl">  VERNEED              0x0000000000002178
</span></span><span class="line"><span class="cl">  VERNEEDNUM           0x0000000000000001
</span></span><span class="line"><span class="cl">  VERSYM               0x000000000000202e
</span></span><span class="line"><span class="cl">  RELACOUNT            0x0000000000000003
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Version References:
</span></span><span class="line"><span class="cl">  required from libc.so.6:
</span></span><span class="line"><span class="cl">    0x09691a75 0x00 <span class="m">02</span> GLIBC_2.2.5
</span></span></code></pre></div><p>Ref:</p>
<ul>
<li><a href="http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html">Shared Libraries</a></li>
<li><a href="https://stackoverflow.com/questions/12637841/what-is-the-soname-option-for-building-shared-libraries-for">stackoverflow.com</a></li>
</ul>

  </div>
</div>



    
    
    

    
    <script src="/js/navigation-module.js"></script>
    
  </body>

</html>
