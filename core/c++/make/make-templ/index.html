<!DOCTYPE html>
<html lang="en">




  <head>
    <meta charset="utf-8">
<title>My Hugo</title>
<link rel="stylesheet" type="text/css" href="/css/syntax.css">
<link rel="stylesheet" type="text/css" href="/css/site.css">
<script src="/js/nav.js"></script>

    

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



  </head>

  <body>
    
 <div id="menu-container"></div>

 


    
  
<div class="van-content-container">
  <div id="index-container" class="van-content-index"></div>
  <div class="van-content">
    <h1>A Makefile Template</h1>
    <h2 id="module-variables">Module Variables</h2>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Required</th>
<th>Default</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>NAME</td>
<td>yes</td>
<td></td>
<td>mymod</td>
<td>name of module, target name is generated from the module name</td>
</tr>
<tr>
<td>BINNAME</td>
<td></td>
<td></td>
<td></td>
<td>override the convention of target name, see below notes</td>
</tr>
<tr>
<td>TYPE</td>
<td>yes</td>
<td></td>
<td>lib</td>
<td>bin, lib, so, (none)</td>
</tr>
<tr>
<td>SRCS</td>
<td></td>
<td>.</td>
<td></td>
<td>directories that contain source code</td>
</tr>
<tr>
<td>SUBS</td>
<td></td>
<td></td>
<td></td>
<td>list of sub modules</td>
</tr>
<tr>
<td>DEPENDS</td>
<td></td>
<td></td>
<td></td>
<td>list of depends</td>
</tr>
<tr>
<td>DEFS</td>
<td></td>
<td></td>
<td>-Djs</td>
<td>compiler defines</td>
</tr>
<tr>
<td>LDEF</td>
<td></td>
<td></td>
<td>-Dpic</td>
<td>linker defines</td>
</tr>
<tr>
<td>INCS</td>
<td></td>
<td></td>
<td>a/inc b/c</td>
<td>list of include paths, without -I leading</td>
</tr>
<tr>
<td>LIBS</td>
<td></td>
<td></td>
<td>-labc</td>
<td>list of libs with -l, include -L if needed</td>
</tr>
<tr>
<td>OBJS</td>
<td></td>
<td></td>
<td>a.o v</td>
<td>list of extra objects. If an item v is not ended with .o, expand to v/*.o</td>
</tr>
<tr>
<td>ROOT</td>
<td></td>
<td></td>
<td></td>
<td>read-only, set by the template to path to the toplevel makefile</td>
</tr>
<tr>
<td>MKDEP_FLAGS</td>
<td></td>
<td>-MM</td>
<td></td>
<td>compliler flags that generate depend file (.d) from source (.c,cxx)</td>
</tr>
<tr>
<td>INSTALL_INC</td>
<td></td>
<td></td>
<td>1</td>
<td>install include/ (override by INSTALL_INC_DIR)</td>
</tr>
<tr>
<td>INSTALL_LIB</td>
<td></td>
<td></td>
<td>1</td>
<td>install lib/ (override by INSTALL_LIB_DIR)</td>
</tr>
<tr>
<td>INSTALL_BIN</td>
<td></td>
<td></td>
<td>1</td>
<td>install bin/ (override by INSTALL_BIN_DIR)</td>
</tr>
<tr>
<td>INSTALL_DAT</td>
<td></td>
<td></td>
<td>1</td>
<td>install etc/ (override by INSTALL_DAT_DIR)</td>
</tr>
</tbody>
</table>
<p>Note</p>
<ul>
<li>SRCS automatically exclude include/, folders starting with . or _ or tmp.</li>
<li>By default convention, the target name is set according to the module type
<ul>
<li>so - lib$(NAME).so</li>
<li>lib - lib$(NAME).a</li>
<li>bin - $(NAME)</li>
</ul>
</li>
<li>OBJ_EXTRA: extra .o files that are linked into the target. Some secenario are:
<ul>
<li>part of .o files from external depends</li>
<li>subs/depends are not libs/shared-objects</li>
<li>.o files are linked into the target even they are not explicitly referenced (e.g. referenced by static constructors)</li>
</ul>
</li>
<li>variables prefix:
<ul>
<li>OS_ OS level variables</li>
<li>EXT_ external resources</li>
<li>PRJ_ project level</li>
</ul>
</li>
</ul>
<h2 id="defined-functions">Defined Functions</h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Syntax</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>_join</td>
<td>call _join, list,sep</td>
<td>join list by sep (default=:)</td>
</tr>
<tr>
<td>_relpath</td>
<td>call _replpath,list,base</td>
<td>return a list of base-relative path, base=ROOT</td>
</tr>
<tr>
<td>_pathname</td>
<td>call _pathname,list</td>
<td>strip tailing / for each in list if applicable</td>
</tr>
<tr>
<td>_eq</td>
<td>call _eq,v1,v2</td>
<td>if v1 eques v2</td>
</tr>
<tr>
<td>_mkinc</td>
<td>call _mkinc,list,base</td>
<td>prepend base/ to list unless it is abspath, base=mod.root</td>
</tr>
<tr>
<td>_exclude</td>
<td>call _exclude,src,pattern</td>
<td>exclude pattern from src, both are lists</td>
</tr>
<tr>
<td>_unique</td>
<td>call _unique,list</td>
<td>remove duplicated words in the list, without order change</td>
</tr>
<tr>
<td>_print</td>
<td>call _print,val,title</td>
<td>print val if not empty, title=</td>
</tr>
<tr>
<td>_vprint</td>
<td>call _vprint,val,title</td>
<td>the same with _print, if VERBOSE</td>
</tr>
<tr>
<td>_println</td>
<td>call _println,list,title</td>
<td>print list, one line by each word</td>
</tr>
<tr>
<td>_vprintln</td>
<td>call _vprintln,list,title</td>
<td>the same with _println, if VERBOSE</td>
</tr>
<tr>
<td>_olist</td>
<td>call _olist,list</td>
<td>list .o files, expand to $v/*.o if $v is not ended by .o</td>
</tr>
<tr>
<td>_merge</td>
<td>call _merge,name,dfl</td>
<td>merge and unique: merge name with prefix OS_,EXT_,PRJ_</td>
</tr>
</tbody>
</table>

  </div>
</div>



    
    
    

    
    <script src="/js/menu-module.js"></script>
    <script src="/js/index-module.js"></script>
  </body>

</html>
