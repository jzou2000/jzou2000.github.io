<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>My Hugo</title>
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/site.css">
    <script src="/js/nav.js"></script>

    

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



  </head>

<head>
  <meta charset="utf-8">
    <title>My Hugo</title>
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <link rel="stylesheet" type="text/css" href="/css/site.css">
    <script src="/js/nav.js"></script>

  

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>



</head>

<body>
    
 <div id="menu-container"></div>

 


    
  
<div class="van-content-container">
  <div id="index-container" class="van-content-index"></div>
  <div class="van-content">
    <h1>Build My Hugo Site</h1>
    <h2 id="what-i-have-already">What I have already</h2>
<p>On github, I have these repos, they have been modified locally</p>
<ul>
<li>kbase - my knowledgebase markdown source</li>
<li>jzou2000.github.io - my static site</li>
</ul>
<p>On my local workstation, I have</p>
<ul>
<li>hugo/alpine docker</li>
<li>empty hugo site <code>myhugo</code></li>
<li>theme <code>van</code> developped in above site <code>myhugo</code></li>
<li>some scripts that run hugo to generate the site and express.js to serve it</li>
</ul>
<h2 id="setup-hugo-work-folder">Setup hugo work folder</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> <span class="nv">$hugo_wks</span>
</span></span><span class="line"><span class="cl">docker run -it --rm -u <span class="k">$(</span>id -u<span class="k">)</span>:<span class="k">$(</span>id -g<span class="k">)</span> -v <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>:/src klakegg/hugo new site --force .
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> themes
</span></span><span class="line"><span class="cl">git clone https://github.com/jzou2000/van
</span></span></code></pre></div><h2 id="push-my-theme-to-github">Push my theme to github</h2>
<ol>
<li>create a repo named <code>van</code>. After the repo is created, github shows
steps to pull or push.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># create a new repositiory on the command line</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;# van&#34;</span> &gt;&gt; README.md
</span></span><span class="line"><span class="cl">git init
</span></span><span class="line"><span class="cl">git add README.md
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;first commit&#34;</span>
</span></span><span class="line"><span class="cl">git remote add origin https://github.com/jzou2000/van.git
</span></span><span class="line"><span class="cl">git push -u origin master
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># push an existing repoistory from the command line</span>
</span></span><span class="line"><span class="cl">git remote add origin https://github.com/jzou2000/van.git
</span></span><span class="line"><span class="cl">git push -u origin master
</span></span></code></pre></div></li>
<li>go to theme folder to create a local repo
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~/ssg/myhugo/themes/van
</span></span><span class="line"><span class="cl">git init
</span></span><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">git commit -m <span class="s1">&#39;initial commit of van, my ssg hugo theme&#39;</span>
</span></span></code></pre></div></li>
<li>follow the push step to push local van repo to github
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git remote add origin https://github.com/jzou2000/van.git
</span></span><span class="line"><span class="cl">git push -u origin master
</span></span></code></pre></div></li>
</ol>
<h2 id="set-chroma-for-highlight-style">Set chroma for highlight style</h2>
<p>Hugo has a bunch of stocked chroma for it highlighter, they can be exported
to CSS using following command.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">hugo gen chromastyles --style<span class="o">=</span>monokai &gt; syntax.css
</span></span></code></pre></div><p>Choose the proper style name (if not monokai) and save the css file to the theme static folder. In theme <code>van</code>, the style is based on <code>vs</code> and saved in <code>static/css</code>.</p>
<p>To let the chroma css take effect, add following lines in config.yaml</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">pygmentsUseClasses</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">pygmentsCodefences</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><h2 id="my-configyaml">My Config.yaml</h2>
<p>I prefer yaml to toml, here is my config.yaml</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">My Hugo Site</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">theme</span><span class="p">:</span><span class="w"> </span><span class="l">van</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">languageCode</span><span class="p">:</span><span class="w"> </span><span class="l">en-us</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">hasCJKLanguage</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metaDataFormat</span><span class="p">:</span><span class="w"> </span><span class="l">yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">defaultContentLanguage</span><span class="p">:</span><span class="w"> </span><span class="l">en</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">pygmentsCodeFences</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">pygmentsUseClasses</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">markup</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">goldmark</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">renderer</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">unsafe</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><h2 id="create-a-docker-image">Create a Docker Image</h2>
<p>The <code>Dockerfile</code> in the build folder</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-docker" data-lang="docker"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s"> klakegg/hugo</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /src</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> hugo new site . <span class="p">;</span><span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    rm config.toml<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ADD</span> config.yaml /src<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ADD</span> van /src/themes/van<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ADD</span> cmd /bin<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;/bin/cmd&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></div><p>The script <code>/bin/cmd</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#! /bin/sh
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;shell&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">  <span class="nb">shift</span>
</span></span><span class="line"><span class="cl">  /bin/sh <span class="nv">$*</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">  hugo <span class="nv">$*</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span></code></pre></div><p>Run to build the image</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mingw:jasonz@VANLWIN0056 /c/myhub/myhugo
</span></span><span class="line"><span class="cl">$ docker build -t myhugo .
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Building 0.3s <span class="o">(</span>11/11<span class="o">)</span> <span class="nv">FINISHED</span>
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>internal<span class="o">]</span> load .dockerignore                                   0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; transferring context: 2B                                     0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>internal<span class="o">]</span> load build definition from Dockerfile                0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; transferring dockerfile: 32B                                 0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>internal<span class="o">]</span> load metadata <span class="k">for</span> docker.io/klakegg/hugo:latest      0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>1/6<span class="o">]</span> FROM docker.io/klakegg/hugo                               0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>internal<span class="o">]</span> load build context                                   0.1s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; transferring context: 94.13kB                                0.1s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; CACHED <span class="o">[</span>2/6<span class="o">]</span> WORKDIR /src                                       0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; CACHED <span class="o">[</span>3/6<span class="o">]</span> RUN hugo new site . <span class="p">;</span>    rm config.toml            0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; CACHED <span class="o">[</span>4/6<span class="o">]</span> ADD config.yaml /src                               0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>5/6<span class="o">]</span> ADD van /src/themes/van                                   0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">[</span>6/6<span class="o">]</span> ADD cmd /bin                                              0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; exporting to image                                              0.1s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; exporting layers                                             0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; writing image sha256:26a309e9152f26261f5870ac54de3115e61924  0.0s
</span></span><span class="line"><span class="cl"> <span class="o">=</span>&gt; <span class="o">=</span>&gt; naming to docker.io/library/myhugo                           0.0s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mingw:jasonz@VANLWIN0056 /c/myhub/mh
</span></span><span class="line"><span class="cl">$ docker images
</span></span><span class="line"><span class="cl">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
</span></span><span class="line"><span class="cl">myhugo              latest              26a309e9152f        <span class="m">2</span> minutes ago       47.6MB
</span></span><span class="line"><span class="cl">node                slim                922b09b21278        <span class="m">5</span> days ago          165MB
</span></span><span class="line"><span class="cl">node                latest              ca36fba5ad66        <span class="m">5</span> days ago          941MB
</span></span><span class="line"><span class="cl">node                alpine              1e8b781248bb        <span class="m">5</span> days ago          115MB
</span></span><span class="line"><span class="cl">klakegg/hugo        latest              1688b3d839d3        <span class="m">10</span> days ago         47.5MB
</span></span><span class="line"><span class="cl">alpine              latest              a24bb4013296        <span class="m">5</span> months ago        5.57MB
</span></span></code></pre></div><h2 id="regular-publish-steps">Regular Publish Steps</h2>
<ol>
<li>commit and push markdown pages
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~/myhub/kbase
</span></span><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">git commit -m <span class="s1">&#39;I have updted some content in md&#39;</span>
</span></span><span class="line"><span class="cl">git push
</span></span></code></pre></div></li>
<li>run hugo (via docker) to generate the site (html)
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">runhugo -N -g kbase books bookmarks
</span></span><span class="line"><span class="cl"><span class="c1"># the target folder will be</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ~/myhub/jzou2000.github.io</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -N   don&#39;t use docker name (there&#39;s another hugo docker for locaer webs)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -g   for github</span>
</span></span></code></pre></div></li>
<li>push hugo output to github
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~/myhub/jzou2000.github.io
</span></span><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">git commit -m <span class="s1">&#39;update the site&#39;</span>
</span></span><span class="line"><span class="cl">git push
</span></span></code></pre></div></li>
</ol>
<h2 id="use-netlify">Use netlify</h2>
<p>To be finished.</p>

  </div>
</div>



    
    
    

    
    <script src="/js/menu-module.js"></script>
    <script src="/js/index-module.js"></script>
</body>
</html>
